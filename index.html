<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Alolo Fr√ºchte-Galerie</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿØÿßÿ°: preload ŸÑÿ®ÿπÿ∂ ÿßŸÑÿµŸàÿ± ÿßŸÑŸÖŸáŸÖÿ© -->
    <link rel="preload" as="image" href="https://1212mohamadalolo.github.io/Alolo---new-test-004/images/apfel.jpg">
    <link rel="preload" as="image" href="https://1212mohamadalolo.github.io/Alolo---new-test-004/images/banane.jpg">
    <link rel="preload" as="image" href="https://1212mohamadalolo.github.io/Alolo---new-test-004/images/orange.jpg">
    <link rel="preload" as="image" href="https://1212mohamadalolo.github.io/Alolo---new-test-004/images/erdbeere.jpg">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.webmanifest">

    <style>
        :root {
            --blue: #0b2340;
            --yellow: #f5c33b;
            --yellow-soft: #ffdf80;
            --text-light: #fdfdfd;
            --shadow-strong: 0 12px 25px rgba(0, 0, 0, 0.35);
            --shadow-soft: 0 8px 16px rgba(0, 0, 0, 0.22);
            --radius-card: 18px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: linear-gradient(135deg, var(--blue) 50%, var(--yellow) 50%);
            color: var(--text-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background 0.3s ease, color 0.3s ease;
        }

        header {
            text-align: center;
            padding: 1.8rem 1rem 0.5rem;
            position: relative;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.25rem 0.8rem;
            border-radius: 999px;
            border: 1px solid var(--yellow-soft);
            font-size: 0.8rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            margin-bottom: 0.7rem;
            background-color: rgba(0, 0, 0, 0.25);
        }

        .badge-icon {
            font-size: 1rem;
        }

        h1 {
            font-size: clamp(2rem, 3vw, 2.6rem);
            margin-bottom: 0.3rem;
        }

        .subtitle {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        /* ÿ≤ÿ± ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÑŸäŸÑŸä/ÿßŸÑŸÜŸáÿßÿ±Ÿä */
        .theme-toggle {
            position: absolute;
            right: 1.2rem;
            top: 1.2rem;
            padding: 0.3rem 0.8rem;
            border-radius: 999px;
            border: 1px solid rgba(245, 195, 59, 0.6);
            background: rgba(0, 0, 0, 0.4);
            color: var(--text-light);
            font-size: 0.8rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            backdrop-filter: blur(6px);
            transition: background 0.2s ease, transform 0.1s ease;
        }

        .theme-toggle span.icon {
            font-size: 1rem;
        }

        .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.65);
            transform: translateY(-1px);
        }

        /* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ≠ÿßŸÑÿ© (XP + ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™) */
        .top-status {
            max-width: 1200px;
            margin: 0.9rem auto 0;
            padding: 0 1rem 0.7rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            justify-content: center;
            align-items: center;
        }

        .xp-pill {
            padding: 0.25rem 0.8rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            background: rgba(0, 0, 0, 0.35);
            font-size: 0.8rem;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
        }

        .xp-pill-icon {
            font-size: 1rem;
        }

        .cert-badges {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            flex-wrap: wrap;
        }

        .cert-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .cert-icons-row {
            display: inline-flex;
            gap: 0.2rem;
            flex-wrap: wrap;
        }

        .cert-icon {
            width: 1.4rem;
            height: 1.4rem;
            border-radius: 999px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .cert-icon.highlight {
            background: linear-gradient(135deg, var(--yellow-soft), #f97316);
            color: #111827;
        }

        /* ÿ™ŸÜŸÇŸëŸÑ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ ŸÖÿ´ŸÑ ÿ™ÿ®ŸàŸäÿ®ÿßÿ™ Duolingo */
        .main-nav {
            max-width: 1200px;
            margin: 0.4rem auto 0;
            padding: 0 1rem 0.8rem;
            display: flex;
            justify-content: center;
            gap: 0.4rem;
        }

        .nav-tab {
            flex: 0 0 auto;
            min-width: 110px;
            padding: 0.45rem 0.9rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.45);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-light);
            font-size: 0.85rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
            transition: background 0.2s ease, transform 0.1s ease, border-color 0.2s ease;
        }

        .nav-tab-icon {
            font-size: 1rem;
        }

        .nav-tab:hover {
            background: rgba(0, 0, 0, 0.6);
            transform: translateY(-1px);
            border-color: var(--yellow-soft);
        }

        .nav-tab.active {
            background: var(--yellow-soft);
            color: #111827;
            border-color: var(--yellow-soft);
        }

        main {
            width: 100%;
            max-width: 1200px;
            margin: 0.6rem auto 3rem;
            padding: 0 1rem 2rem;
        }

        .page {
            display: none;
            animation: fadeIn 0.25s ease;
        }

        .page.page-active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===============================
           ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ÿ≠ŸÉŸÖ: ÿ®ÿ≠ÿ´ + ŸÅŸÑÿßÿ™ÿ± + ÿ∑ÿ®ÿßÿπÿ© + ÿ™ŸÇÿØŸëŸÖ
           =============================== */
        .controls {
            margin-bottom: 1.5rem;
            background: rgba(0, 0, 0, 0.25);
            border-radius: 16px;
            padding: 0.9rem 1rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
        }

        .controls-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            align-items: center;
            margin-bottom: 0.6rem;
        }

        .search-input {
            flex: 1 1 180px;
            min-width: 0;
        }

        .search-input input {
            width: 100%;
            padding: 0.45rem 0.7rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.28);
            background: rgba(0, 0, 0, 0.35);
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .search-input input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .control-button {
            padding: 0.4rem 0.9rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.35);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-light);
            font-size: 0.8rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            transition: background 0.2s ease, transform 0.1s ease, border-color 0.2s ease;
            white-space: nowrap;
        }

        .control-button.small {
            padding: 0.25rem 0.6rem;
            font-size: 0.75rem;
        }

        .control-button:hover {
            background: rgba(0, 0, 0, 0.6);
            transform: translateY(-1px);
            border-color: var(--yellow-soft);
        }

        .control-button.active {
            background: var(--yellow-soft);
            color: #111827;
            border-color: var(--yellow-soft);
        }

        .filters {
            flex-wrap: wrap;
        }

        .filters-label {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-right: 0.4rem;
        }

        .progress-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            align-items: center;
        }

        .progress-label {
            font-size: 0.8rem;
        }

        .daily-challenge {
            margin-top: 0.6rem;
            padding: 0.85rem 0.9rem;
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            background: rgba(7, 17, 32, 0.95);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            gap: 0.65rem;
        }

        .daily-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.6rem;
        }

        .daily-label {
            font-size: 0.75rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            opacity: 0.9;
        }

        .daily-title {
            font-size: 1rem;
            font-weight: 700;
        }

        .daily-body {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: 0.75rem;
            align-items: center;
        }

        .daily-img {
            width: 100%;
            aspect-ratio: 4 / 3;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.12);
            background: rgba(0, 0, 0, 0.15);
        }

        .daily-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .daily-info {
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }

        .daily-names {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
            align-items: baseline;
            font-size: 0.95rem;
        }

        .daily-de {
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.18rem 0.5rem;
            border-radius: 999px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.16);
        }

        .daily-ar {
            color: var(--yellow-soft);
            font-weight: 600;
        }

        .daily-example {
            font-size: 0.82rem;
            opacity: 0.95;
        }

        .daily-hint {
            font-size: 0.78rem;
            opacity: 0.85;
        }

        .daily-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
        }

        .progress-track {
            flex: 1 1 180px;
            height: 0.55rem;
            border-radius: 999px;
            background: rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            border-radius: 999px;
            background: linear-gradient(90deg, #34d399, #22c55e);
            transition: width 0.25s ease;
        }

        .quiz-info {
            font-size: 0.8rem;
            opacity: 0.85;
        }

        /* ===============================
           ÿµŸÅÿ≠ÿ© Schnell-Quiz (A1)
           =============================== */
        .quiz-section {
            background: rgba(0, 0, 0, 0.25);
            border-radius: 16px;
            padding: 0.9rem 1rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(10px);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.7rem;
        }

        .quiz-title {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .quiz-subtitle {
            font-size: 0.8rem;
            opacity: 0.85;
        }

        .quiz-meta {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .quiz-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 0.7rem;
        }

        .quiz-card {
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            background: rgba(7, 17, 32, 0.96);
            padding: 0.6rem 0.7rem;
            display: flex;
            gap: 0.55rem;
        }

        .quiz-card-img {
            flex: 0 0 80px;
            aspect-ratio: 1 / 1;
            overflow: hidden;
            border-radius: 10px;
        }

        .quiz-card-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .quiz-card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .quiz-ar {
            font-size: 0.9rem;
            color: var(--yellow-soft);
        }

        .quiz-de {
            font-size: 0.9rem;
            display: none;
        }

        .quiz-status {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-top: 0.1rem;
        }

        .quiz-actions {
            display: flex;
            gap: 0.3rem;
            flex-wrap: wrap;
            margin-top: 0.2rem;
        }

        .quiz-card.known {
            border-color: #22c55e;
        }

        .quiz-card.unknown {
            border-color: #ef4444;
        }

        /* ===============================
           ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ (Card + Flip)
           =============================== */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 1.1rem;
        }

        .card {
            background: transparent;
            border-radius: var(--radius-card);
            perspective: 1000px;
        }

        .card-inner {
            position: relative;
            border-radius: var(--radius-card);
            overflow: hidden;
            border: 1px solid rgba(245, 195, 59, 0.35);
            box-shadow: var(--shadow-strong);
            display: flex;
            flex-direction: column;
            transition:
                transform 0.5s ease,
                box-shadow 0.2s ease,
                border-color 0.2s ease,
                background 0.3s ease;
            transform-style: preserve-3d;
            background: rgba(11, 35, 64, 0.95);
        }

        .card:hover .card-inner {
            box-shadow: 0 18px 35px rgba(0, 0, 0, 0.5);
            border-color: var(--yellow-soft);
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-face {
            position: relative;
            inset: 0;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
        }

        .card-front {
            z-index: 2;
        }

        .card-back {
            position: absolute;
            inset: 0;
            transform: rotateY(180deg);
            background: rgba(7, 17, 32, 0.98);
            padding-bottom: 0.9rem;
        }

        .card-front::before,
        .card-back::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top left,
                    rgba(245, 195, 59, 0.18),
                    transparent 55%);
            pointer-events: none;
        }

        .card:hover .de-name {
            transform: translateY(-1px);
        }

        .card:hover .ar-name {
            transform: translateY(1px);
        }

        .image-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            overflow: hidden;
            cursor: zoom-in;
        }

        .image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transform: scale(1.02);
            transition: transform 0.25s ease;
        }

        .card:hover .image-wrapper img {
            transform: scale(1.06);
        }

        .card-body {
            padding: 0.85rem 1rem 0.9rem;
            position: relative;
            z-index: 1;
        }

        .de-line {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.25rem;
            gap: 0.4rem;
        }

        .de-main {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        .article {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--yellow-soft);
            padding: 0.1rem 0.6rem;
            border-radius: 999px;
            border: 1px solid rgba(245, 195, 59, 0.55);
            background-color: rgba(0, 0, 0, 0.3);
            flex-shrink: 0;
            position: relative;
            cursor: help;
        }

        .de-name {
            font-weight: 600;
            font-size: 1rem;
            transition: transform 0.15s ease;
        }

        .speak-btn {
            border: none;
            background: rgba(0, 0, 0, 0.3);
            color: var(--yellow-soft);
            border-radius: 999px;
            padding: 0.1rem 0.45rem;
            font-size: 0.9rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            transition: background 0.15s ease, transform 0.1s ease, opacity 0.15s ease;
        }

        .speak-btn:hover {
            background: rgba(0, 0, 0, 0.55);
            transform: translateY(-1px);
        }

        .speak-btn[disabled] {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .level-pill {
            font-size: 0.7rem;
            padding: 0.1rem 0.5rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            opacity: 0.85;
            white-space: nowrap;
        }

        .ar-name {
            font-size: 0.9rem;
            margin-top: 0.25rem;
            color: var(--yellow-soft);
            text-align: left;
            transition: transform 0.15s ease;
        }

        .code-path {
            margin-top: 0.35rem;
            font-size: 0.7rem;
            opacity: 0.9;
            font-family: "Fira Code", "Cascadia Code", monospace;
            background: rgba(0, 0, 0, 0.4);
            padding: 0.3rem 0.45rem;
            border-radius: 999px;
            display: inline-block;
        }

        .card-footer-row {
            margin-top: 0.45rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.35rem;
            flex-wrap: wrap;
        }

        .learn-toggle {
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            background: rgba(0, 0, 0, 0.25);
            padding: 0.18rem 0.6rem;
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            color: var(--text-light);
            transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease;
        }

        .learn-toggle:hover {
            background: rgba(0, 0, 0, 0.6);
            transform: translateY(-1px);
        }

        .learn-toggle .learn-icon {
            font-size: 0.9rem;
        }

        .flip-toggle {
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            padding: 0.18rem 0.55rem;
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            cursor: pointer;
            color: var(--text-light);
        }

        .flip-toggle:hover {
            background: rgba(0, 0, 0, 0.35);
        }

        .card-learned .card-inner {
            border-color: #34d399;
            box-shadow: 0 14px 30px rgba(16, 185, 129, 0.38);
        }

        .card-learned .learn-icon {
            color: #4ade80;
        }

        .card-learned .learn-label {
            opacity: 0.9;
        }

        /* ÿßŸÑŸàÿ¨Ÿá ÿßŸÑÿÆŸÑŸÅŸä: ŸÖÿ´ÿßŸÑ ÿ¨ŸÖŸÑÿ© */
        .card-back-content {
            padding: 0.9rem 1rem 1.1rem;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }

        .example-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            opacity: 0.75;
            margin-bottom: 0.3rem;
        }

        .example-de {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .example-ar {
            font-size: 0.9rem;
            color: var(--yellow-soft);
        }

        /* ===============================
           ÿµŸÅÿ≠ÿ© ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ (Zertifikate)
           =============================== */
        .cert-page-header {
            margin-bottom: 0.8rem;
        }

        .cert-page-header h2 {
            font-size: 1.1rem;
            margin-bottom: 0.2rem;
        }

        .cert-page-header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .cert-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 0.9rem;
        }

        .idea-board {
            margin: 1.5rem 0 0;
            padding: 1rem;
            border-radius: var(--radius-card);
            background: rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-soft);
        }

        .idea-header {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            align-items: baseline;
            margin-bottom: 0.75rem;
        }

        .idea-controls {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .idea-select,
        .idea-toggle-btn {
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.08);
            color: inherit;
            padding: 0.35rem 0.75rem;
            font-size: 0.85rem;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.1s ease, border-color 0.2s ease;
        }

        .idea-select:focus,
        .idea-toggle-btn:focus {
            outline: 2px solid var(--yellow-soft);
            outline-offset: 2px;
            border-color: var(--yellow-soft);
        }

        .idea-toggle-btn[aria-pressed="true"] {
            background: rgba(34, 197, 94, 0.18);
            border-color: rgba(34, 197, 94, 0.7);
        }

        .idea-title {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .idea-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .idea-counter {
            font-size: 0.9rem;
            padding: 0.35rem 0.75rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.08);
            white-space: nowrap;
        }

        .idea-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 0.75rem;
        }

        .idea-card {
            border-radius: var(--radius-card);
            padding: 0.85rem;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: grid;
            gap: 0.35rem;
            box-shadow: var(--shadow-soft);
        }

        .idea-card h4 {
            font-size: 1rem;
        }

        .idea-desc {
            font-size: 0.9rem;
            opacity: 0.9;
            line-height: 1.4;
        }

        .idea-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
        }

        .idea-tag {
            font-size: 0.75rem;
            padding: 0.15rem 0.5rem;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.06);
        }

        .idea-meta {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .idea-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
        }

        .idea-toggle {
            border: 1px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.1);
            color: inherit;
            border-radius: 999px;
            padding: 0.35rem 0.75rem;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.2s ease, transform 0.1s ease;
        }

        .idea-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .idea-card-done {
            border-color: rgba(54, 211, 153, 0.6);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.18), rgba(255, 255, 255, 0.05));
        }

        .idea-empty {
            text-align: center;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .idea-card-done .idea-toggle {
            background: rgba(34, 197, 94, 0.15);
            border-color: rgba(34, 197, 94, 0.7);
        }

        .cert-card {
            position: relative;
            border-radius: 18px;
            padding: 0.9rem 1rem 0.9rem;
            background: linear-gradient(135deg, rgba(11, 35, 64, 0.96), rgba(245, 195, 59, 0.2));
            border: 1px solid rgba(245, 195, 59, 0.6);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);
        }

        .cert-ribbon {
            position: absolute;
            top: 0.4rem;
            right: 0.6rem;
            padding: 0.15rem 0.7rem;
            border-radius: 999px;
            background: var(--yellow-soft);
            color: #111827;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .cert-title {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.15rem;
        }

        .cert-meta {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-bottom: 0.4rem;
        }

        .cert-text-de {
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        .cert-text-ar {
            font-size: 0.85rem;
            color: var(--yellow-soft);
        }

        footer {
            text-align: center;
            font-size: 0.8rem;
            padding: 0.8rem 1rem 1.2rem;
            color: rgba(255, 255, 255, 0.78);
            transition: color 0.3s ease;
        }

        .sr-only {
            position: absolute !important;
            height: 1px; width: 1px;
            overflow: hidden;
            clip: rect(1px, 1px, 1px, 1px);
            white-space: nowrap;
        }

        /* ===============================
           Ÿàÿ∂ÿπ ŸÜŸáÿßÿ±Ÿä (Light Mode)
           =============================== */
        body[data-theme="light"] {
            background: linear-gradient(135deg, #fef7e3 50%, #e2ecff 50%);
            color: #102a43;
        }

        body[data-theme="light"] .badge {
            background-color: rgba(255, 255, 255, 0.7);
            color: #102a43;
            border-color: #f5c33b;
        }

        body[data-theme="light"] .theme-toggle {
            background: rgba(255, 255, 255, 0.9);
            color: #102a43;
            border-color: rgba(16, 42, 67, 0.25);
        }

        body[data-theme="light"] .theme-toggle:hover {
            background: rgba(255, 255, 255, 1);
        }

        body[data-theme="light"] .controls,
        body[data-theme="light"] .quiz-section {
            background: rgba(255, 255, 255, 0.82);
            border-color: rgba(15, 23, 42, 0.08);
        }

        body[data-theme="light"] .search-input input {
            background: rgba(255, 255, 255, 0.9);
            color: #111827;
            border-color: rgba(15, 23, 42, 0.12);
        }

        body[data-theme="light"] .search-input input::placeholder {
            color: rgba(75, 85, 99, 0.85);
        }

        body[data-theme="light"] .control-button {
            background: rgba(255, 255, 255, 0.9);
            color: #111827;
            border-color: rgba(15, 23, 42, 0.12);
        }

        body[data-theme="light"] .control-button:hover {
            background: rgba(255, 255, 255, 1);
        }

        body[data-theme="light"] .control-button.active {
            background: #111827;
            color: #f9fafb;
            border-color: #111827;
        }

        body[data-theme="light"] .daily-challenge {
            background: rgba(255, 255, 255, 0.92);
            border-color: rgba(15, 23, 42, 0.08);
        }

        body[data-theme="light"] .daily-de {
            background: rgba(15, 23, 42, 0.05);
            border-color: rgba(15, 23, 42, 0.12);
            color: #0f172a;
        }

        body[data-theme="light"] .card-inner {
            background: rgba(255, 255, 255, 0.96);
            border-color: rgba(16, 42, 67, 0.16);
            box-shadow: 0 10px 20px rgba(15, 23, 42, 0.12);
        }

        body[data-theme="light"] .card-back {
            background: rgba(241, 245, 249, 0.98);
        }

        body[data-theme="light"] .article {
            background-color: rgba(255, 248, 230, 0.9);
            border-color: rgba(245, 195, 59, 0.7);
            color: #b7791f;
        }

        body[data-theme="light"] .ar-name {
            color: #b7791f;
        }

        body[data-theme="light"] .code-path {
            background: rgba(15, 23, 42, 0.04);
            color: #4b5563;
        }

        body[data-theme="light"] footer {
            color: #1f2933;
        }

        body[data-theme="light"] .speak-btn {
            background: rgba(15, 23, 42, 0.06);
            color: #b7791f;
        }

        body[data-theme="light"] .speak-btn:hover {
            background: rgba(15, 23, 42, 0.12);
        }

        body[data-theme="light"] .learn-toggle {
            background: rgba(15, 23, 42, 0.03);
            color: #111827;
        }

        body[data-theme="light"] .cert-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(254, 243, 199, 0.95));
            color: #1f2933;
        }

        body[data-theme="light"] .cert-text-ar {
            color: #b7791f;
        }

        body[data-theme="light"] .idea-board {
            background: rgba(255, 255, 255, 0.7);
            border-color: rgba(11, 35, 64, 0.12);
        }

        body[data-theme="light"] .idea-card {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(11, 35, 64, 0.12);
        }

        body[data-theme="light"] .idea-toggle {
            border-color: rgba(11, 35, 64, 0.35);
            background: rgba(11, 35, 64, 0.05);
        }

        /* ===============================
           Modal ŸÑÿ™ŸÉÿ®Ÿäÿ± ÿßŸÑÿµŸàÿ±
           =============================== */
        .image-modal {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
            z-index: 999;
        }

        .image-modal.open {
            opacity: 1;
            pointer-events: auto;
        }

        .image-modal-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }

        .image-modal-dialog {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            width: min(900px, 90vw);
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
            z-index: 1;
        }

        .image-modal-frame {
            background: #000;
            border-radius: 18px;
            overflow: hidden;
            aspect-ratio: 16 / 9;
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.65);
        }

        .image-modal-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .image-modal-caption {
            font-size: 0.9rem;
            color: #f9fafb;
            text-align: center;
        }

        .image-modal-close {
            position: absolute;
            top: -0.6rem;
            right: -0.6rem;
            width: 2.2rem;
            height: 2.2rem;
            border-radius: 999px;
            border: none;
            cursor: button;
            cursor: pointer;
            background: #f5c33b;
            color: #111827;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        .image-modal-close:hover {
            transform: translateY(-1px);
        }

        /* ===============================
           ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿπŸÑŸâ ÿßŸÑŸÖŸàÿ®ÿßŸäŸÑ
           =============================== */
        @media (max-width: 700px) {
            header {
                padding-top: 1.4rem;
            }

            .theme-toggle {
                top: 0.8rem;
                right: 0.8rem;
            }

            .controls,
            .quiz-section {
                padding: 0.7rem 0.7rem 0.8rem;
            }

            .card-body {
                padding: 0.7rem 0.75rem 0.8rem;
            }

            .card-back-content {
                padding: 0.7rem 0.75rem 0.9rem;
            }

            .gallery {
                gap: 0.9rem;
            }

            .card-inner {
                box-shadow: var(--shadow-soft);
            }

            .code-path {
                display: none;
            }

            .top-status {
                padding-bottom: 0.4rem;
            }
        }

        /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ∏ŸÑÿßŸÑ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ™Ÿä ÿ™ŸÅÿ∂ŸëŸÑ ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ≠ÿ±ŸÉÿ© */
        @media (prefers-reduced-motion: reduce) {
            .card-inner,
            .image-modal-frame {
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
                transition: none;
            }

            .card:hover .image-wrapper img {
                transform: none;
            }

            .page {
                animation: none;
            }
        }

        /* ===============================
           Ÿàÿ∂ÿπ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© (Print View ‚Äì A4)
           =============================== */
        @media print {
            @page {
                size: A4;
                margin: 10mm;
            }

            body {
                background: #ffffff !important;
                color: #000000 !important;
            }

            header {
                padding: 4mm 0 2mm;
            }

            .theme-toggle,
            .image-modal,
            .nav-tab,
            .control-button,
            .speak-btn,
            .flip-toggle {
                display: none !important;
            }

            .top-status {
                padding: 0 0 2mm;
                margin-bottom: 2mm;
                justify-content: flex-start;
            }

            main {
                margin: 0;
                padding: 0;
                max-width: 100%;
            }

            .page {
                display: block !important;
                margin-top: 2mm;
            }

            /* ŸÜÿ∑ÿ®ÿπ ÿµŸÅÿ≠ÿ© ÿßŸÑÿ™ÿπŸÑŸÖ + ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ ŸÅŸÇÿ∑ */
            #page-quiz {
                display: none !important;
            }

            .gallery {
                grid-template-columns: repeat(4, 1fr);
                gap: 2mm;
                padding: 0;
            }

            .card-inner {
                box-shadow: none !important;
                border-radius: 4px;
                border: 0.3pt solid #000000;
                background: #ffffff !important;
            }

            .card-body {
                padding: 2mm 2mm 3mm;
            }

            .image-wrapper {
                aspect-ratio: 4 / 3;
            }

            .article,
            .de-name,
            .ar-name {
                font-size: 8pt;
            }

            .level-pill,
            .learn-toggle {
                display: none !important;
            }

            .card-back {
                display: none !important;
            }

            .cert-list {
                grid-template-columns: repeat(2, 1fr);
                gap: 3mm;
            }

            .cert-card {
                box-shadow: none !important;
                border-radius: 4px;
                border: 0.3pt solid #000000;
                background: #ffffff !important;
                color: #000 !important;
                padding: 3mm 3mm 3mm;
            }

            .cert-text-ar {
                color: #000000 !important;
            }

            footer {
                margin-top: 3mm;
                color: #000000;
                font-size: 7pt;
            }
        }
    </style>
</head>
<body data-theme="dark">
<header>
    <button class="theme-toggle" type="button" aria-label="Farbschema wechseln">
        <span class="icon" aria-hidden="true">üåô</span>
        <span class="label">Nachtmodus</span>
    </button>

    <div class="badge">
        <span class="badge-icon">üçã</span>
        <span>Alolo ¬∑ Deutsch &amp; Arabisch ¬∑ Fr√ºchte</span>
    </div>
    <h1>Interaktiver Fr√ºchte-Katalog</h1>
    <p class="subtitle">
        Galerie
        <span lang="ar" dir="rtl">
            ÿ®ÿµÿ±ŸäŸëÿ© ŸÑÿ™ÿπŸÑŸëŸÖ ÿ£ÿ≥ŸÖÿßÿ° ÿßŸÑŸÅŸàÿßŸÉŸá ÿ®ÿßŸÑÿ£ŸÑŸÖÿßŸÜŸäÿ© ŸàÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿ∂ŸÖŸÜ ŸáŸàŸäÿ© ÿ®ÿµÿ±Ÿäÿ© Ÿàÿßÿ≠ÿØÿ©.
        </span>
    </p>
</header>

<!-- ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ≠ÿßŸÑÿ© ŸÖÿ´ŸÑ Duolingo (XP + Zertifikate) -->
<div class="top-status">
    <div class="xp-pill">
        <span class="xp-pill-icon">‚≠ê</span>
        <span><span id="xpValue">0</span> XP</span>
    </div>
    <div class="cert-badges">
        <span class="cert-label">Zertifikate:</span>
        <div id="certIcons" class="cert-icons-row"></div>
    </div>
</div>

<!-- ÿ™ŸÜŸÇŸëŸÑ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ -->
<nav class="main-nav" aria-label="Hauptnavigation">
    <button class="nav-tab active" data-target="page-learn" type="button">
        <span class="nav-tab-icon">üìö</span>
        <span>Lernen</span>
    </button>
    <button class="nav-tab" data-target="page-quiz" type="button">
        <span class="nav-tab-icon">‚ö°</span>
        <span>Schnell-Quiz</span>
    </button>
    <button class="nav-tab" data-target="page-certificates" type="button">
        <span class="nav-tab-icon">üìú</span>
        <span>Zertifikate</span>
    </button>
</nav>

<main role="main">
    <!-- ÿµŸÅÿ≠ÿ© 1: ÿßŸÑÿ™ÿπŸÑŸëŸÖ (ÿßŸÑŸÉÿ±Ÿàÿ™) -->
    <section id="page-learn" class="page page-active" aria-label="Lern-Katalog">
        <section class="controls" aria-label="Filter und Lernfortschritt">
            <div class="controls-row">
                <div class="search-input">
                    <input id="searchInput" type="search"
                           placeholder="Suche nach Obst (Deutsch oder ÿπÿ±ÿ®Ÿä)...">
                </div>
                <button id="lightningQuizBtn" class="control-button" type="button">
                    ‚ö° Schnell-Quiz (A1)
                </button>
                <button id="printBtn" class="control-button" type="button">
                    üñ®Ô∏è Seite als PDF drucken
                </button>
            </div>

            <div class="controls-row filters">
                <span class="filters-label">Filter:</span>
                <button class="control-button filter-btn active" data-filter="all" type="button">
                    Alle
                </button>
                <button class="control-button filter-btn" data-filter="A1" type="button">
                    Niveau A1
                </button>
                <button class="control-button filter-btn" data-filter="A2" type="button">
                    Niveau A2
                </button>
                <button class="control-button filter-btn" data-filter="Zitrusfrucht" type="button">
                    Zitrusfr√ºchte
                </button>
                <button class="control-button filter-btn" data-filter="Beere" type="button">
                    Beeren
                </button>
                <button class="control-button filter-btn" data-filter="Exotisch" type="button">
                    Exotisch
                </button>
            </div>

            <div class="controls-row progress-row">
                <div class="progress-label">
                    Lernfortschritt:
                    <span id="progressText">0 / 0</span>
                </div>
                <div class="progress-track">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="quiz-info" id="quizInfo"></div>
            </div>

            <div class="daily-challenge" id="dailyChallenge" aria-live="polite">
                <div class="daily-header">
                    <div>
                        <div class="daily-label">T√§gliche Mini-Aufgabe</div>
                        <div class="daily-title" id="dailyTitle"></div>
                    </div>
                    <button id="refreshDailyBtn" class="control-button small" type="button">
                        üîÑ Neu laden
                    </button>
                </div>
                <div class="daily-body">
                    <div class="daily-img">
                        <img id="dailyImg" src="" alt="">
                    </div>
                    <div class="daily-info">
                        <div class="daily-names">
                            <div class="daily-de" id="dailyDe"></div>
                            <div class="daily-ar" id="dailyAr" lang="ar" dir="rtl"></div>
                        </div>
                        <p class="daily-example" id="dailyExample"></p>
                        <div class="daily-actions">
                            <button id="dailySpeakBtn" class="control-button small" type="button">
                                üîä Aussprache
                            </button>
                            <button id="dailyLearnBtn" class="control-button small" type="button">
                                ‚òÖ Als gelernt z√§hlen
                            </button>
                        </div>
                        <div class="daily-hint" id="dailyHint"></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="gallery" aria-label="Galerie der Fr√ºchte">
            <!-- ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ÿ™ŸàŸÑŸëŸéÿØ ŸáŸÜÿß ÿ®ÿßŸÑŸÄ JavaScript -->
        </section>
    </section>

    <!-- ÿµŸÅÿ≠ÿ© 2: Schnell-Quiz (A1) -->
    <section id="page-quiz" class="page" aria-label="Schnell-Quiz A1">
        <section class="quiz-section">
            <div class="quiz-header">
                <div>
                    <div class="quiz-title">‚ö° Schnell-Quiz (A1)</div>
                    <div class="quiz-subtitle">
                        Schau dir das Bild und das arabische Wort an, dann klicke auf ‚ÄûL√∂sung zeigen‚Äú
                        und markiere, ob du es wusstest.
                    </div>
                    <div class="quiz-meta" id="quizMeta"></div>
                </div>
                <button id="quizCloseBtn" class="control-button small" type="button">
                    ‚¨Ö Zur√ºck zum Lernen
                </button>
            </div>
            <div class="quiz-list" id="quizList">
                <!-- ÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑŸÉŸàŸäÿ≤ ÿ™ŸàŸÑŸëŸéÿØ ŸáŸÜÿß -->
            </div>
        </section>
    </section>

    <!-- ÿµŸÅÿ≠ÿ© 3: ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ -->
    <section id="page-certificates" class="page" aria-label="Zertifikate">
        <div class="cert-page-header">
            <h2>Deine Zertifikate</h2>
            <p>
                Hier findest du alle Zertifikate, die du im Alolo Fr√ºchte-Katalog erhalten hast.
                Jede Urkunde best√§tigt deinen Lernfortschritt auf einfache und freundliche Art.
            </p>
        </div>
        <div class="controls-row" style="margin-bottom:0.8rem;">
            <button id="generateCertBtn" class="control-button" type="button">
                üìú Zertifikat erzeugen
            </button>
            <div style="font-size:0.8rem; opacity:0.9;">
                Tipp: Je mehr Karten du als ‚ÄûGelernt‚Äú markierst, desto aussagekr√§ftiger wird dein Zertifikat.
            </div>
        </div>
        <div class="idea-board" aria-label="Roadmap und Entwicklungs-Ideen">
            <div class="idea-header">
                <div>
                    <div class="idea-title">Ideen f√ºr die Weiterentwicklung</div>
                    <p class="idea-subtitle">
                        Mini-Roadmap mit Verbesserungen zu Motivation, Lernen und Barrierefreiheit. Markiere, was du schon getestet hast.
                    </p>
                </div>
                <div
                    class="idea-counter"
                    id="ideaCounter"
                    role="status"
                    aria-live="polite"
                    aria-atomic="true"
                >
                    0 / 0
                </div>
            </div>
            <div class="idea-controls" aria-label="Filter und Sortierung f√ºr die Roadmap">
                <label class="sr-only" for="ideaTagFilter">Nach Kategorie filtern</label>
                <select id="ideaTagFilter" class="idea-select">
                    <option value="all">Alle Kategorien</option>
                </select>
                <label class="sr-only" for="ideaSortSelect">Sortierung w√§hlen</label>
                <select id="ideaSortSelect" class="idea-select">
                    <option value="impact">Wirkung: hoch ‚Üí niedrig</option>
                    <option value="effort">Aufwand: niedrig ‚Üí hoch</option>
                    <option value="alpha">Alphabetisch</option>
                    <option value="status">Status: getestet zuerst</option>
                </select>
                <button
                    id="ideaDoneToggle"
                    class="idea-toggle-btn"
                    type="button"
                    aria-pressed="false"
                >
                    Nur getestete anzeigen
                </button>
            </div>
            <div id="ideaLiveRegion" class="sr-only" aria-live="polite" aria-atomic="true"></div>
            <div class="idea-grid" id="ideaList"></div>
        </div>
        <div id="certList" class="cert-list">
            <!-- ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ ÿ™ŸàŸÑŸëŸéÿØ ŸáŸÜÿß -->
        </div>
    </section>
</main>

<footer>
    ¬© 2025 ¬∑ Alolo Visual Language Lab ¬∑ ÿ™ÿµŸÖŸäŸÖ ÿ´ŸÜÿßÿ¶Ÿä ÿßŸÑŸÑÿ∫ÿ© (Deutsch / ÿπÿ±ÿ®Ÿä) ŸÑÿ™ÿπŸÑŸëŸÖ ÿßŸÑŸÖŸÅÿ±ÿØÿßÿ™ ÿ®ÿ£ÿ≥ŸÑŸàÿ® ÿ®ÿµÿ±Ÿä ŸÖŸàÿ≠ŸëÿØ.
</footer>

<!-- Modal ŸÑÿ™ŸÉÿ®Ÿäÿ± ÿßŸÑÿµŸàÿ± -->
<div class="image-modal" aria-hidden="true">
    <div class="image-modal-backdrop"></div>
    <div class="image-modal-dialog" role="dialog" aria-modal="true">
        <button class="image-modal-close" type="button" aria-label="Bild schlie√üen">√ó</button>
        <div class="image-modal-frame">
            <img src="" alt="">
        </div>
        <p class="image-modal-caption"></p>
    </div>
</div>

<script>
    // ==============================
    // PWA: ÿ™ÿ≥ÿ¨ŸäŸÑ Service Worker ÿ®ÿ≥Ÿäÿ∑
    // ==============================
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js').catch(() => {});
    }

    const THEME_KEY = 'alolo-fruits-theme';
    const LEARNED_KEY = 'alolo-fruits-learned';
    const CERT_KEY = 'alolo-fruits-certificates';
    const IDEA_KEY = 'alolo-fruits-ideas';

    // ÿπŸÜÿßÿµÿ± ÿßŸÑÿ™ÿ®ÿØŸäŸÑ ÿ®ŸäŸÜ ÿßŸÑŸàÿ∂ÿπŸäŸÜ
    const themeToggleBtn = document.querySelector('.theme-toggle');
    const themeToggleLabel = themeToggleBtn.querySelector('.label');
    const themeToggleIcon = themeToggleBtn.querySelector('.icon');

    function applyTheme(theme) {
        document.body.setAttribute('data-theme', theme);

        if (theme === 'light') {
            themeToggleLabel.textContent = 'Tagmodus';
            themeToggleIcon.textContent = '‚òÄÔ∏é';
        } else {
            themeToggleLabel.textContent = 'Nachtmodus';
            themeToggleIcon.textContent = 'üåô';
        }
    }

    const savedTheme = localStorage.getItem(THEME_KEY);
    if (savedTheme === 'light' || savedTheme === 'dark') {
        applyTheme(savedTheme);
    } else {
        applyTheme('dark');
    }

    themeToggleBtn.addEventListener('click', () => {
        const currentTheme = document.body.getAttribute('data-theme') || 'dark';
        const nextTheme = currentTheme === 'dark' ? 'light' : 'dark';
        applyTheme(nextTheme);
        localStorage.setItem(THEME_KEY, nextTheme);
    });

    // ==============================
    // Modal ŸÑÿ™ŸÉÿ®Ÿäÿ± ÿßŸÑÿµŸàÿ±
    // ==============================
    const imageModal = document.querySelector('.image-modal');
    const imageModalImg = imageModal.querySelector('.image-modal-frame img');
    const imageModalCaption = imageModal.querySelector('.image-modal-caption');
    const imageModalCloseBtn = imageModal.querySelector('.image-modal-close');
    const imageModalBackdrop = imageModal.querySelector('.image-modal-backdrop');

    function openImageModal(src, alt, captionText) {
        imageModalImg.src = src;
        imageModalImg.alt = alt || '';
        imageModalCaption.textContent = captionText || '';
        imageModal.classList.add('open');
        imageModal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
    }

    function closeImageModal() {
        imageModal.classList.remove('open');
        imageModal.setAttribute('aria-hidden', 'true');
        imageModalImg.src = '';
        imageModalImg.alt = '';
        imageModalCaption.textContent = '';
        document.body.style.overflow = '';
    }

    imageModalCloseBtn.addEventListener('click', closeImageModal);
    imageModalBackdrop.addEventListener('click', closeImageModal);
    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && imageModal.classList.contains('open')) {
            closeImageModal();
        }
    });

    // ==============================
    // ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÜÿ∑ŸÇ (Speech Synthesis)
    // ==============================
    const supportsSpeech = 'speechSynthesis' in window && 'SpeechSynthesisUtterance' in window;

    function speakGerman(text) {
        if (!supportsSpeech) {
            alert('Die Sprachausgabe wird von diesem Browser leider nicht unterst√ºtzt.');
            return;
        }
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'de-DE';
        utterance.rate = 0.95;
        utterance.pitch = 1;
        window.speechSynthesis.cancel();
        window.speechSynthesis.speak(utterance);
    }

    // ==============================
    // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅŸàÿßŸÉŸá
    // ==============================
    const fruits = [
        {
            id: 'apfel',
            article: 'der',
            genusHint: 'maskulines Nomen (der)',
            deName: 'Apfel',
            arName: 'ÿ™ŸÅÿßÿ≠ÿ©',
            level: 'Niveau A1 ¬∑ Obst',
            levelCode: 'A1',
            category: 'Kernobst',
            tagGroup: 'Kernobst',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/apfel.jpg',
            alt: 'Apfel ‚Äî ÿ™ŸÅÿßÿ≠ÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/apfel.jpg',
            exampleDe: 'Ich esse jeden Morgen einen Apfel.',
            exampleAr: 'ÿ¢ŸÉŸÑ ÿ™ŸÅÿßÿ≠ÿ© ŸÉŸÑ ÿµÿ®ÿßÿ≠.'
        },
        {
            id: 'banane',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Banane',
            arName: 'ŸÖŸàÿ≤ÿ©',
            level: 'Niveau A1 ¬∑ Obst',
            levelCode: 'A1',
            category: 'Obst',
            tagGroup: 'Obst',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/banane.jpg',
            alt: 'Banane ‚Äî ŸÖŸàÿ≤ÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/banane.jpg',
            exampleDe: 'Die Banane ist sehr s√º√ü.',
            exampleAr: 'ÿßŸÑŸÖŸàÿ≤ÿ© ÿ≠ŸÑŸàÿ© ÿ¨ÿØÿßŸã.'
        },
        {
            id: 'orange',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Orange',
            arName: 'ÿ®ÿ±ÿ™ŸÇÿßŸÑÿ©',
            level: 'Zitrusfrucht',
            levelCode: 'A1',
            category: 'Zitrusfrucht',
            tagGroup: 'Zitrusfrucht',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/orange.jpg',
            alt: 'Orange ‚Äî ÿ®ÿ±ÿ™ŸÇÿßŸÑÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/orange.jpg',
            exampleDe: 'Zum Fr√ºhst√ºck trinke ich Orangensaft.',
            exampleAr: 'ÿ£ÿ¥ÿ±ÿ® ÿπÿµŸäÿ± ÿßŸÑÿ®ÿ±ÿ™ŸÇÿßŸÑ ÿπŸÑŸâ ÿßŸÑŸÅÿ∑Ÿàÿ±.'
        },
        {
            id: 'traube',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Traube',
            arName: 'ÿπŸÜÿ®',
            level: 'Niveau A1 ¬∑ Obst',
            levelCode: 'A1',
            category: 'Beere',
            tagGroup: 'Beere',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/traube.jpg',
            alt: 'Traube ‚Äî ÿπŸÜÿ®',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/traube.jpg',
            exampleDe: 'Die Trauben sind frisch und lecker.',
            exampleAr: 'ÿßŸÑÿπŸÜÿ® ÿ∑ÿßÿ≤ÿ¨ ŸàŸÑÿ∞Ÿäÿ∞.'
        },
        {
            id: 'erdbeere',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Erdbeere',
            arName: 'ŸÅÿ±ÿßŸàŸÑÿ©',
            level: 'Beere',
            levelCode: 'A1',
            category: 'Beere',
            tagGroup: 'Beere',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/erdbeere.jpg',
            alt: 'Erdbeere ‚Äî ŸÅÿ±ÿßŸàŸÑÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/erdbeere.jpg',
            exampleDe: 'Die Kinder m√∂gen Erdbeeren mit Sahne.',
            exampleAr: 'ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ Ÿäÿ≠ÿ®ŸàŸÜ ÿßŸÑŸÅÿ±ÿßŸàŸÑÿ© ŸÖÿπ ÿßŸÑŸÉÿ±ŸäŸÖÿ©.'
        },
        {
            id: 'kirsche',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Kirsche',
            arName: 'ŸÉÿ±ÿ≤',
            level: 'Beere',
            levelCode: 'A2',
            category: 'Beere',
            tagGroup: 'Beere',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/kirsche.jpg',
            alt: 'Kirsche ‚Äî ŸÉÿ±ÿ≤',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/kirsche.jpg',
            exampleDe: 'Der Kuchen mit Kirschen schmeckt gut.',
            exampleAr: 'ÿßŸÑŸÉÿπŸÉÿ© ÿ®ÿßŸÑŸÉÿ±ÿ≤ ÿ∑ÿπŸÖŸáÿß ŸÑÿ∞Ÿäÿ∞.'
        },
        {
            id: 'ananas',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Ananas',
            arName: 'ÿ£ŸÜÿßŸÜÿßÿ≥',
            level: 'Exotisches Obst',
            levelCode: 'A2',
            category: 'Exotisch',
            tagGroup: 'Exotisch',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/ananas.jpg',
            alt: 'Ananas ‚Äî ÿ£ŸÜÿßŸÜÿßÿ≥',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/ananas.jpg',
            exampleDe: 'Die Ananas ist sehr saftig.',
            exampleAr: 'ÿßŸÑÿ£ŸÜÿßŸÜÿßÿ≥ ÿπÿµŸäÿ±Ÿä ÿ¨ÿØÿßŸã.'
        },
        {
            id: 'mango',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Mango',
            arName: 'ŸÖÿßŸÜÿ¨ÿß',
            level: 'Exotisches Obst',
            levelCode: 'A2',
            category: 'Exotisch',
            tagGroup: 'Exotisch',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/mango.jpg',
            alt: 'Mango ‚Äî ŸÖÿßŸÜÿ¨ÿß',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/mango.jpg',
            exampleDe: 'Mango ist meine Lieblingsfrucht.',
            exampleAr: 'ÿßŸÑŸÖÿßŸÜÿ¨ÿß ŸáŸä ŸÅÿßŸÉŸáÿ™Ÿä ÿßŸÑŸÖŸÅÿ∂ŸëŸÑÿ©.'
        },
        {
            id: 'birne',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Birne',
            arName: 'ÿ•ÿ¨Ÿëÿßÿµÿ©',
            level: 'Niveau A1 ¬∑ Obst',
            levelCode: 'A1',
            category: 'Kernobst',
            tagGroup: 'Kernobst',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/birne.jpg',
            alt: 'Birne ‚Äî ÿ•ÿ¨Ÿëÿßÿµÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/birne.jpg',
            exampleDe: 'Ich kaufe Birnen auf dem Markt.',
            exampleAr: 'ÿ£ÿ¥ÿ™ÿ±Ÿä ÿßŸÑÿ•ÿ¨ÿßÿµ ŸÖŸÜ ÿßŸÑÿ≥ŸàŸÇ.'
        },
        {
            id: 'melone',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Melone',
            arName: 'ÿ®ÿ∑ŸäÿÆ / ÿ¥ŸÖŸëÿßŸÖ',
            level: 'Sommerobst',
            levelCode: 'A1',
            category: 'Obst',
            tagGroup: 'Obst',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/melone.jpg',
            alt: 'Melone ‚Äî ÿ®ÿ∑ŸäÿÆ / ÿ¥ŸÖŸëÿßŸÖ',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/melone.jpg',
            exampleDe: 'Im Sommer essen wir gern Melone.',
            exampleAr: 'ŸÅŸä ÿßŸÑÿµŸäŸÅ ŸÜÿ≠ÿ® ÿ£ŸÉŸÑ ÿßŸÑÿ®ÿ∑ŸäÿÆ.'
        },
        {
            id: 'zitrone',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Zitrone',
            arName: 'ŸÑŸäŸÖŸàŸÜÿ©',
            level: 'Zitrusfrucht',
            levelCode: 'A2',
            category: 'Zitrusfrucht',
            tagGroup: 'Zitrusfrucht',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/zitrone.jpg',
            alt: 'Zitrone ‚Äî ŸÑŸäŸÖŸàŸÜÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/zitrone.jpg',
            exampleDe: 'Der Tee mit Zitrone ist warm.',
            exampleAr: 'ÿßŸÑÿ¥ÿßŸä ÿ®ÿßŸÑŸÑŸäŸÖŸàŸÜ ÿØÿßŸÅÿ¶.'
        },
        {
            id: 'pflaume',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Pflaume',
            arName: 'ÿ®ÿ±ŸÇŸàŸÇ',
            level: 'Niveau A2 ¬∑ Obst',
            levelCode: 'A2',
            category: 'Obst',
            tagGroup: 'Obst',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/pflaume.jpg',
            alt: 'Pflaume ‚Äî ÿ®ÿ±ŸÇŸàŸÇ',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/pflaume.jpg',
            exampleDe: 'Aus Pflaumen macht man Marmelade.',
            exampleAr: 'ŸäŸèÿµŸÜÿπ ŸÖŸÜ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ ŸÖÿ±ÿ®ŸëŸâ.'
        },
        {
            id: 'kiwi',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Kiwi',
            arName: 'ŸÉŸäŸàŸä',
            level: 'Exotisches Obst',
            levelCode: 'A2',
            category: 'Exotisch',
            tagGroup: 'Exotisch',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/kiwi.jpg',
            alt: 'Kiwi ‚Äî ŸÉŸäŸàŸä',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/kiwi.jpg',
            exampleDe: 'Die Kiwi ist klein, aber gesund.',
            exampleAr: 'ÿßŸÑŸÉŸäŸàŸä ÿµÿ∫Ÿäÿ±ÿ© ŸÑŸÉŸÜŸáÿß ÿµÿ≠Ÿäÿ©.'
        },
        {
            id: 'grapefruit',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Grapefruit',
            arName: 'ÿ¨ÿ±Ÿäÿ® ŸÅÿ±Ÿàÿ™',
            level: 'Zitrusfrucht',
            levelCode: 'A2',
            category: 'Zitrusfrucht',
            tagGroup: 'Zitrusfrucht',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/grapefruit.jpg',
            alt: 'Grapefruit ‚Äî ÿ¨ÿ±Ÿäÿ® ŸÅÿ±Ÿàÿ™',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/grapefruit.jpg',
            exampleDe: 'Grapefruit schmeckt ein bisschen bitter.',
            exampleAr: 'ÿßŸÑÿ¨ÿ±Ÿäÿ® ŸÅÿ±Ÿàÿ™ ÿ∑ÿπŸÖŸá ŸÖÿßÿ¶ŸÑ ŸÑŸÑŸÖÿ±ÿßÿ±ÿ©.'
        },
        {
            id: 'mandarine',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Mandarine',
            arName: 'ŸÖÿßŸÜÿØÿ±ŸäŸÜ / ŸäŸàÿ≥ŸÅŸä',
            level: 'Zitrusfrucht',
            levelCode: 'A1',
            category: 'Zitrusfrucht',
            tagGroup: 'Zitrusfrucht',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/mandarine.jpg',
            alt: 'Mandarine ‚Äî ŸÖÿßŸÜÿØÿ±ŸäŸÜ / ŸäŸàÿ≥ŸÅŸä',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/mandarine.jpg',
            exampleDe: 'Im Winter essen viele Leute Mandarinen.',
            exampleAr: 'ŸÅŸä ÿßŸÑÿ¥ÿ™ÿßÿ° Ÿäÿ£ŸÉŸÑ ÿßŸÑŸÉÿ´Ÿäÿ± ŸÖŸÜ ÿßŸÑŸÜÿßÿ≥ ÿßŸÑŸäŸàÿ≥ŸÅŸä.'
        },
        {
            id: 'kokosnuss',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Kokosnuss',
            arName: 'ÿ¨Ÿàÿ≤ ÿßŸÑŸáŸÜÿØ',
            level: 'Exotisches Obst',
            levelCode: 'A2',
            category: 'Exotisch',
            tagGroup: 'Exotisch',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/kokosnuss.jpg',
            alt: 'Kokosnuss ‚Äî ÿ¨Ÿàÿ≤ ÿßŸÑŸáŸÜÿØ',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/kokosnuss.jpg',
            exampleDe: 'Aus der Kokosnuss trinkt man Kokoswasser.',
            exampleAr: 'ŸÖŸÜ ÿ´ŸÖÿ±ÿ© ÿ¨Ÿàÿ≤ ÿßŸÑŸáŸÜÿØ ŸÜÿ¥ÿ±ÿ® ŸÖÿßÿ° ÿ¨Ÿàÿ≤ ÿßŸÑŸáŸÜÿØ.'
        },
        {
            id: 'dattel',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Dattel',
            arName: 'ÿ™ŸÖÿ±ÿ©',
            level: 'Niveau A1 ¬∑ Obst',
            levelCode: 'A1',
            category: 'Exotisch',
            tagGroup: 'Exotisch',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/dattel.jpg',
            alt: 'Dattel ‚Äî ÿ™ŸÖÿ±ÿ©',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/dattel.jpg',
            exampleDe: 'Im Ramadan essen viele Menschen Datteln.',
            exampleAr: 'ŸÅŸä ÿ±ŸÖÿ∂ÿßŸÜ Ÿäÿ£ŸÉŸÑ ÿßŸÑŸÉÿ´Ÿäÿ± ŸÖŸÜ ÿßŸÑŸÜÿßÿ≥ ÿßŸÑÿ™ŸÖÿ±.'
        },
        {
            id: 'feige',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Feige',
            arName: 'ÿ™ŸäŸÜ',
            level: 'Niveau A2 ¬∑ Obst',
            levelCode: 'A2',
            category: 'Exotisch',
            tagGroup: 'Exotisch',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/feige.jpg',
            alt: 'Feige ‚Äî ÿ™ŸäŸÜ',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/feige.jpg',
            exampleDe: 'Die Feige w√§chst in warmen L√§ndern.',
            exampleAr: 'ÿßŸÑÿ™ŸäŸÜ ŸäŸÜŸÖŸà ŸÅŸä ÿßŸÑÿ®ŸÑÿØÿßŸÜ ÿßŸÑÿØÿßŸÅÿ¶ÿ©.'
        },
        {
            id: 'himbeere',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Himbeere',
            arName: 'ÿ™Ÿàÿ™ ÿ£ÿ≠ŸÖÿ±',
            level: 'Beere',
            levelCode: 'A2',
            category: 'Beere',
            tagGroup: 'Beere',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/himbeere.jpg',
            alt: 'Himbeere ‚Äî ÿ™Ÿàÿ™ ÿ£ÿ≠ŸÖÿ±',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/himbeere.jpg',
            exampleDe: 'Himbeeren sind sehr weich.',
            exampleAr: 'ÿßŸÑÿ™Ÿàÿ™ ÿßŸÑÿ£ÿ≠ŸÖÿ± ÿ∑ÿ±Ÿä ÿ¨ÿØÿßŸã.'
        },
        {
            id: 'brombeere',
            article: 'die',
            genusHint: 'feminines Nomen (die)',
            deName: 'Brombeere',
            arName: 'ÿ™Ÿàÿ™ ÿ£ÿ≥ŸàÿØ',
            level: 'Beere',
            levelCode: 'A2',
            category: 'Beere',
            tagGroup: 'Beere',
            img: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/brombeere.jpg',
            alt: 'Brombeere ‚Äî ÿ™Ÿàÿ™ ÿ£ÿ≥ŸàÿØ',
            codePath: 'https://1212mohamadalolo.github.io/Alolo---new-test-004/images/brombeere.jpg',
            exampleDe: 'Die Brombeeren wachsen im Wald.',
            exampleAr: 'ÿßŸÑÿ™Ÿàÿ™ ÿßŸÑÿ£ÿ≥ŸàÿØ ŸäŸÜŸÖŸà ŸÅŸä ÿßŸÑÿ∫ÿßÿ®ÿ©.'
        }
    ];

    const totalFruits = fruits.length;

    const roadmapIdeas = [
        {
            id: 'streaks',
            title: 'Streak & Wochenziel',
            desc: 'Ein Wochenziel (z. B. 70 XP) mit Streak-Anzeige motiviert zum t√§glichen Lernen und k√∂nnte an den XP-Pillen andocken.',
            tags: ['Motivation', 'XP'],
            impact: 'hoch',
            effort: 'mittel'
        },
        {
            id: 'flashcards',
            title: 'Spaced Repetition Karten',
            desc: 'Kleine Wiederholungs-Decks, die automatisch ungelernte Fr√ºchte h√§ufiger zeigen. Ideal als zweiter Modus neben dem Schnell-Quiz.',
            tags: ['Lernlogik', 'Quiz'],
            impact: 'hoch',
            effort: 'hoch'
        },
        {
            id: 'audio-clips',
            title: 'Offline Audio-Clips',
            desc: 'Kurze, lokal zwischengespeicherte Audio-Snippets pro Frucht, damit die Aussprache auch ohne Netz abrufbar bleibt.',
            tags: ['PWA', 'Barrierefreiheit'],
            impact: 'mittel',
            effort: 'mittel'
        },
        {
            id: 'achievements',
            title: 'Mini-Erfolge & Abzeichen',
            desc: 'Badges f√ºr ‚Äûerste 5 Karten‚Äú, ‚Äûalle Zitrusfr√ºchte‚Äú oder ‚Äû3 Tage am St√ºck gelernt‚Äú verkn√ºpfen XP mit klaren Etappen.',
            tags: ['Gamification'],
            impact: 'mittel',
            effort: 'niedrig'
        },
        {
            id: 'print-pack',
            title: 'Druckbares K√§rtchen-Paket',
            desc: 'Export als druckfreundliche Lernkarten mit Vorder-/R√ºckseite (DE/AR + Beispielsatz) f√ºr Offline-√úbung.',
            tags: ['Druck', 'Offline'],
            impact: 'mittel',
            effort: 'mittel'
        },
        {
            id: 'accessibility',
            title: 'Barrierefreiheit & Tastatursteuerung',
            desc: 'Fokus-Ring, ARIA-Rollen und Tastaturk√ºrzel (N√§chste Karte, Flip, Markieren) verbessern die Nutzung auf Desktop.',
            tags: ['A11y'],
            impact: 'hoch',
            effort: 'niedrig'
        }
    ];

    // ==============================
    // ÿπŸÜÿßÿµÿ± ÿπÿßŸÖÿ© Ÿà state
    // ==============================
    const gallery = document.querySelector('.gallery');
    const searchInput = document.getElementById('searchInput');
    const filterButtons = document.querySelectorAll('.filter-btn');
    const progressText = document.getElementById('progressText');
    const progressBar = document.getElementById('progressBar');
    const printBtn = document.getElementById('printBtn');
    const quizInfo = document.getElementById('quizInfo');
    const xpValueEl = document.getElementById('xpValue');
    const certIconsEl = document.getElementById('certIcons');
    const ideaListEl = document.getElementById('ideaList');
    const ideaCounterEl = document.getElementById('ideaCounter');
    const ideaLiveRegion = document.getElementById('ideaLiveRegion');
    const ideaTagFilter = document.getElementById('ideaTagFilter');
    const ideaSortSelect = document.getElementById('ideaSortSelect');
    const ideaDoneToggle = document.getElementById('ideaDoneToggle');
    const navTabs = document.querySelectorAll('.nav-tab');
    const pages = document.querySelectorAll('.page');

    const lightningQuizBtn = document.getElementById('lightningQuizBtn');
    const quizSectionPage = document.getElementById('page-quiz');
    const quizSection = document.querySelector('.quiz-section');
    const quizCloseBtn = document.getElementById('quizCloseBtn');
    const quizList = document.getElementById('quizList');
    const quizMeta = document.getElementById('quizMeta');

    const certListEl = document.getElementById('certList');
    const generateCertBtn = document.getElementById('generateCertBtn');

    const dailyTitleEl = document.getElementById('dailyTitle');
    const dailyImgEl = document.getElementById('dailyImg');
    const dailyDeEl = document.getElementById('dailyDe');
    const dailyArEl = document.getElementById('dailyAr');
    const dailyExampleEl = document.getElementById('dailyExample');
    const dailyHintEl = document.getElementById('dailyHint');
    const refreshDailyBtn = document.getElementById('refreshDailyBtn');
    const dailySpeakBtn = document.getElementById('dailySpeakBtn');
    const dailyLearnBtn = document.getElementById('dailyLearnBtn');

    let searchQuery = '';
    let activeFilter = 'all';

    // learnedSet ŸÖŸÜ localStorage
    let learnedSet = new Set();
    {
        const storedLearned = localStorage.getItem(LEARNED_KEY);
        if (storedLearned) {
            try {
                const arr = JSON.parse(storedLearned);
                if (Array.isArray(arr)) {
                    learnedSet = new Set(arr);
                }
            } catch (_) {}
        }
    }

    // ÿ¥ŸáÿßÿØÿßÿ™ ŸÖŸÜ localStorage
    let certificates = [];
    {
        const storedCerts = localStorage.getItem(CERT_KEY);
        if (storedCerts) {
            try {
                const arr = JSON.parse(storedCerts);
                if (Array.isArray(arr)) {
                    certificates = arr;
                }
            } catch (_) {}
        }
    }

    // ÿ•ÿ≠ÿµÿßÿ°ÿßÿ™ Schnell-Quiz
    let quizStats = {
        total: 0,
        correct: 0
    };

    let dailyOffset = 0;
    let completedIdeas = new Set();
    let lastIdeaFocusId = null;
    let activeIdeaTag = 'all';
    let ideaSortMode = 'impact';
    let showOnlyDoneIdeas = false;

    const storedIdeas = localStorage.getItem(IDEA_KEY);
    if (storedIdeas) {
        try {
            const parsedIdeas = JSON.parse(storedIdeas);
            if (Array.isArray(parsedIdeas)) {
                completedIdeas = new Set(parsedIdeas);
            }
        } catch (e) {
            completedIdeas = new Set();
        }
    }

    function saveLearned() {
        localStorage.setItem(LEARNED_KEY, JSON.stringify(Array.from(learnedSet)));
    }

    function saveCertificates() {
        localStorage.setItem(CERT_KEY, JSON.stringify(certificates));
    }

    function saveIdeas() {
        localStorage.setItem(IDEA_KEY, JSON.stringify(Array.from(completedIdeas)));
    }

    function calculateXP() {
        // XP ÿ®ÿ≥Ÿäÿ∑: ŸÉŸÑ ŸÉŸÑŸÖÿ© ŸÖÿ™ÿπŸÑŸÖŸéÿ© = 10 ŸÜŸÇÿßÿ∑
        const xp = learnedSet.size * 10;
        xpValueEl.textContent = xp;
        return xp;
    }

    function updateProgressUI() {
        const learnedCount = learnedSet.size;
        progressText.textContent = `${learnedCount} / ${totalFruits}`;
        const ratio = totalFruits > 0 ? (learnedCount / totalFruits) * 100 : 0;
        progressBar.style.width = `${ratio}%`;
        calculateXP();

        // ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ ÿ≤ÿ± ÿßŸÑÿ™ÿ≠ÿØŸä ÿßŸÑŸäŸàŸÖŸä ŸäÿπŸÉÿ≥ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ™ÿπŸÑŸëŸÖ ÿßŸÑÿ≠ÿßŸÑŸäÿ©
        updateDailyLearnButton(getDailyFruit());
    }

    function updateQuizInfo() {
        if (quizStats.total === 0) {
            quizInfo.textContent = '';
            quizMeta.textContent = '';
            return;
        }
        quizInfo.textContent = `Schnell-Quiz (A1): ${quizStats.correct} / ${quizStats.total} richtig`;
    }

    function getDayIndex(offset = 0) {
        const today = new Date();
        const startOfYear = new Date(today.getFullYear(), 0, 0);
        const diff = today - startOfYear;
        const oneDay = 1000 * 60 * 60 * 24;
        const dayOfYear = Math.floor(diff / oneDay);
        const rawIndex = (dayOfYear + offset) % totalFruits;
        return rawIndex < 0 ? rawIndex + totalFruits : rawIndex;
    }

    function getDailyFruit() {
        if (!fruits.length) return null;
        return fruits[getDayIndex(dailyOffset)];
    }

    function updateDailyLearnButton(fruit) {
        if (!fruit) return;
        const learned = learnedSet.has(fruit.id);
        dailyLearnBtn.textContent = learned ? '‚úì Schon gelernt' : '‚òÖ Als gelernt z√§hlen';
        dailyLearnBtn.classList.toggle('active', learned);
    }

    function renderDailyChallenge() {
        const fruit = getDailyFruit();
        if (!fruit) return;

        dailyTitleEl.textContent = `Fokus des Tages ¬∑ ${fruit.levelCode}`;
        dailyImgEl.src = fruit.img;
        dailyImgEl.alt = fruit.alt || '';
        dailyDeEl.textContent = `${fruit.article} ${fruit.deName}`;
        dailyArEl.textContent = fruit.arName;
        dailyExampleEl.textContent = `${fruit.exampleDe} ‚Äî ${fruit.exampleAr}`;
        dailyHintEl.textContent = `${fruit.category} ¬∑ ${fruit.genusHint}`;
        dailySpeakBtn.disabled = !supportsSpeech;

        updateDailyLearnButton(fruit);
    }

    function normalizeText(str) {
        return (str || '').toString().trim().toLowerCase();
    }

    function fruitMatchesSearch(fruit, query) {
        if (!query) return true;
        const q = normalizeText(query);
        return (
            normalizeText(fruit.deName).includes(q) ||
            normalizeText(fruit.arName).includes(q) ||
            normalizeText(fruit.article + ' ' + fruit.deName).includes(q) ||
            normalizeText(fruit.exampleDe).includes(q) ||
            normalizeText(fruit.exampleAr).includes(q)
        );
    }

    function fruitMatchesFilter(fruit, filter) {
        if (filter === 'all') return true;
        if (filter === 'A1' || filter === 'A2') {
            return fruit.levelCode === filter;
        }
        if (filter === 'Zitrusfrucht' || filter === 'Beere' || filter === 'Exotisch') {
            return fruit.category === filter;
        }
        return true;
    }

    // ==============================
    // ÿ™ŸÜŸÇŸëŸÑ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ (ŸÖÿ´ŸÑ ÿ™ÿ®ŸàŸäÿ®ÿßÿ™ Duolingo)
    // ==============================
    function setActivePage(pageId) {
        pages.forEach(p => {
            if (p.id === pageId) {
                p.classList.add('page-active');
            } else {
                p.classList.remove('page-active');
            }
        });
        navTabs.forEach(btn => {
            if (btn.getAttribute('data-target') === pageId) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
    }

    navTabs.forEach(btn => {
        btn.addEventListener('click', () => {
            const target = btn.getAttribute('data-target');
            setActivePage(target);
        });
    });

    // ==============================
    // ÿ±ÿ≥ŸÖ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ (ÿßŸÑŸÉatalog)
    // ==============================
    function renderFruits() {
        gallery.innerHTML = '';

        const filtered = fruits.filter(fruit =>
            fruitMatchesSearch(fruit, searchQuery) &&
            fruitMatchesFilter(fruit, activeFilter)
        );

        filtered.forEach(fruit => {
            const card = document.createElement('article');
            card.className = 'card';
            if (learnedSet.has(fruit.id)) {
                card.classList.add('card-learned');
            }

            const speakText = `${fruit.article} ${fruit.deName}`;

            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-face card-front">
                        <div class="image-wrapper">
                            <img src="${fruit.img}" alt="${fruit.alt}" loading="lazy">
                        </div>
                        <div class="card-body">
                            <div class="de-line">
                                <div class="de-main">
                                    <span class="article" title="${fruit.genusHint}">
                                        ${fruit.article}
                                    </span>
                                    <span class="de-name">${fruit.deName}</span>
                                    <button class="speak-btn" type="button" aria-label="Aussprache anh√∂ren">
                                        üîä
                                    </button>
                                </div>
                                ${fruit.level
                                    ? `<span class="level-pill">${fruit.level}</span>`
                                    : ''
                                }
                            </div>
                            <div class="ar-name" lang="ar" dir="rtl">${fruit.arName}</div>
                            <div class="code-path">${fruit.codePath}</div>
                            <div class="card-footer-row">
                                <button class="learn-toggle" type="button">
                                    <span class="learn-icon">${learnedSet.has(fruit.id) ? '‚òÖ' : '‚òÜ'}</span>
                                    <span class="learn-label">
                                        ${learnedSet.has(fruit.id) ? 'Gelernt' : 'Als gelernt markieren'}
                                    </span>
                                </button>
                                <button class="flip-toggle" type="button">
                                    ‚Ü∫ Beispiel
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-face card-back">
                        <div class="card-back-content">
                            <div class="example-label">Beispielsatz</div>
                            <div class="example-de">${fruit.exampleDe}</div>
                            <div class="example-ar" lang="ar" dir="rtl">${fruit.exampleAr}</div>
                        </div>
                    </div>
                </div>
            `;

            const imgEl = card.querySelector('.image-wrapper img');
            imgEl.addEventListener('click', () => {
                const caption = `${fruit.article} ${fruit.deName} ‚Äî ${fruit.arName}`;
                openImageModal(fruit.img, fruit.alt, caption);
            });

            // ÿ≤ÿ± ŸÇŸÑÿ® ÿßŸÑÿ®ÿ∑ÿßŸÇÿ©
            const flipBtn = card.querySelector('.flip-toggle');
            flipBtn.addEventListener('click', () => {
                card.classList.toggle('flipped');
            });

            // ÿ≤ÿ± ÿßŸÑŸÜÿ∑ŸÇ
            const speakBtn = card.querySelector('.speak-btn');
            if (!supportsSpeech) {
                speakBtn.disabled = true;
                speakBtn.title = 'Sprachausgabe nicht unterst√ºtzt';
            } else {
                speakBtn.addEventListener('click', () => {
                    speakGerman(speakText);
                });
                speakBtn.title = 'Aussprache anh√∂ren';
            }

            // ÿ≤ÿ±/ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ™ÿπŸÑŸëŸÖ
            const learnToggle = card.querySelector('.learn-toggle');
            const learnIcon = learnToggle.querySelector('.learn-icon');
            const learnLabel = learnToggle.querySelector('.learn-label');

            learnToggle.addEventListener('click', () => {
                if (learnedSet.has(fruit.id)) {
                    learnedSet.delete(fruit.id);
                    card.classList.remove('card-learned');
                    learnIcon.textContent = '‚òÜ';
                    learnLabel.textContent = 'Als gelernt markieren';
                } else {
                    learnedSet.add(fruit.id);
                    card.classList.add('card-learned');
                    learnIcon.textContent = '‚òÖ';
                    learnLabel.textContent = 'Gelernt';
                }
                saveLearned();
                updateProgressUI();
            });

            gallery.appendChild(card);
        });

        updateProgressUI();
    }

    // ==============================
    // ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑÿ®ÿ≠ÿ´ ŸàÿßŸÑŸÅŸÑÿßÿ™ÿ± ŸàÿßŸÑÿ∑ÿ®ÿßÿπÿ©
    // ==============================
    searchInput.addEventListener('input', (e) => {
        searchQuery = e.target.value;
        renderFruits();
    });

    filterButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            filterButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            activeFilter = btn.getAttribute('data-filter') || 'all';
            renderFruits();
        });
    });

    printBtn.addEventListener('click', () => {
        window.print();
    });

    refreshDailyBtn.addEventListener('click', () => {
        if (!totalFruits) return;
        dailyOffset = (dailyOffset + 1) % totalFruits;
        renderDailyChallenge();
    });

    dailySpeakBtn.addEventListener('click', () => {
        const fruit = getDailyFruit();
        if (!fruit) return;
        speakGerman(`${fruit.article} ${fruit.deName}`);
    });

    dailyLearnBtn.addEventListener('click', () => {
        const fruit = getDailyFruit();
        if (!fruit) return;

        if (learnedSet.has(fruit.id)) {
            learnedSet.delete(fruit.id);
        } else {
            learnedSet.add(fruit.id);
        }

        saveLearned();
        updateProgressUI();
        renderFruits();
        renderDailyChallenge();
    });

    // ==============================
    // Roadmap / Ideenboard
    // ==============================
    const impactOrder = { hoch: 0, mittel: 1, niedrig: 2 };
    const effortOrder = { niedrig: 0, mittel: 1, hoch: 2 };
    const ideaSortLabels = {
        impact: 'Wirkung hoch ‚Üí niedrig',
        effort: 'Aufwand niedrig ‚Üí hoch',
        alpha: 'Alphabetisch',
        status: 'Status getestet zuerst'
    };

    function renderIdeaBoard() {
        if (!ideaListEl || !ideaCounterEl) return;

        const focusTargetId = lastIdeaFocusId || document.activeElement?.dataset?.ideaId || null;
        ideaListEl.innerHTML = '';

        const doneCount = completedIdeas.size;
        const completionPercent = roadmapIdeas.length
            ? Math.round((doneCount / roadmapIdeas.length) * 100)
            : 0;

        const filtered = roadmapIdeas.filter(idea => {
            const matchesTag = activeIdeaTag === 'all' || idea.tags.includes(activeIdeaTag);
            const matchesDone = showOnlyDoneIdeas ? completedIdeas.has(idea.id) : true;
            return matchesTag && matchesDone;
        });

        const sortedIdeas = filtered.slice().sort((a, b) => {
            switch (ideaSortMode) {
                case 'effort':
                    return (effortOrder[a.effort] ?? 3) - (effortOrder[b.effort] ?? 3);
                case 'alpha':
                    return a.title.localeCompare(b.title, 'de');
                case 'status': {
                    const aDone = completedIdeas.has(a.id) ? 0 : 1;
                    const bDone = completedIdeas.has(b.id) ? 0 : 1;
                    if (aDone !== bDone) return aDone - bDone;
                    return a.title.localeCompare(b.title, 'de');
                }
                case 'impact':
                default:
                    return (impactOrder[a.impact] ?? 3) - (impactOrder[b.impact] ?? 3);
            }
        });

        ideaCounterEl.textContent = `${doneCount} / ${roadmapIdeas.length} Ideen umgesetzt (${completionPercent}%)`;
        if (ideaLiveRegion) {
            const filterText = activeIdeaTag === 'all' ? 'alle Kategorien' : `Kategorie ${activeIdeaTag}`;
            const statusText = showOnlyDoneIdeas ? 'nur getestete' : 'alle Stati';
            ideaLiveRegion.textContent = `Roadmap-Status aktualisiert: ${doneCount} von ${roadmapIdeas.length} Ideen getestet (${completionPercent}%). Filter: ${filterText}, ${statusText}. Sortierung: ${ideaSortLabels[ideaSortMode]}.`;
        }

        if (sortedIdeas.length === 0) {
            const emptyState = document.createElement('div');
            emptyState.className = 'idea-card idea-empty';
            emptyState.textContent = 'Keine Eintr√§ge f√ºr diesen Filter. W√§hle eine andere Kategorie oder zeige alle Ideen an.';
            ideaListEl.appendChild(emptyState);
        }

        sortedIdeas.forEach(idea => {
            const done = completedIdeas.has(idea.id);
            const card = document.createElement('article');
            card.className = 'idea-card' + (done ? ' idea-card-done' : '');

            card.innerHTML = `
                <h4>${idea.title}</h4>
                <p class="idea-desc">${idea.desc}</p>
                <div class="idea-tags">${idea.tags.map(tag => `<span class="idea-tag">${tag}</span>`).join('')}</div>
                <div class="idea-actions">
                    <div class="idea-meta">Impact: ${idea.impact} ¬∑ Aufwand: ${idea.effort}</div>
                    <button class="idea-toggle" type="button">${done ? '‚úì Getestet' : 'Zu testen'}</button>
                </div>
            `;

            const toggleBtn = card.querySelector('.idea-toggle');
            toggleBtn.dataset.ideaId = idea.id;
            toggleBtn.setAttribute('aria-pressed', done ? 'true' : 'false');
            toggleBtn.setAttribute(
                'aria-label',
                `${done ? 'Als getestet markiert' : 'Zum Testen markieren'}: ${idea.title}`
            );
            toggleBtn.addEventListener('click', () => {
                const wasDone = completedIdeas.has(idea.id);
                lastIdeaFocusId = idea.id;

                if (wasDone) {
                    completedIdeas.delete(idea.id);
                } else {
                    completedIdeas.add(idea.id);
                }

                const updatedDoneCount = completedIdeas.size;
                const updatedPercent = roadmapIdeas.length
                    ? Math.round((updatedDoneCount / roadmapIdeas.length) * 100)
                    : 0;

                if (ideaLiveRegion) {
                    ideaLiveRegion.textContent = `${idea.title}: ${wasDone ? 'auf To-Do zur√ºckgesetzt' : 'als getestet markiert'}. Fortschritt ${updatedDoneCount} / ${roadmapIdeas.length} (${updatedPercent}%).`;
                }

                saveIdeas();
                renderIdeaBoard();
            });

            ideaListEl.appendChild(card);
        });

        if (focusTargetId) {
            const focusBtn = ideaListEl.querySelector(`[data-idea-id="${focusTargetId}"]`);
            if (focusBtn) {
                focusBtn.focus();
            }
        }
        lastIdeaFocusId = null;
    }

    function populateIdeaFilters() {
        if (!ideaTagFilter) return;
        const tagSet = new Set();
        roadmapIdeas.forEach(idea => {
            idea.tags.forEach(tag => tagSet.add(tag));
        });

        const sortedTags = Array.from(tagSet).sort((a, b) => a.localeCompare(b, 'de'));
        sortedTags.forEach(tag => {
            const opt = document.createElement('option');
            opt.value = tag;
            opt.textContent = tag;
            ideaTagFilter.appendChild(opt);
        });
    }

    if (ideaTagFilter) {
        ideaTagFilter.addEventListener('change', () => {
            activeIdeaTag = ideaTagFilter.value;
            renderIdeaBoard();
        });
    }

    if (ideaSortSelect) {
        ideaSortSelect.addEventListener('change', () => {
            ideaSortMode = ideaSortSelect.value;
            renderIdeaBoard();
        });
    }

    if (ideaDoneToggle) {
        ideaDoneToggle.addEventListener('click', () => {
            showOnlyDoneIdeas = !showOnlyDoneIdeas;
            ideaDoneToggle.setAttribute('aria-pressed', showOnlyDoneIdeas ? 'true' : 'false');
            ideaDoneToggle.textContent = showOnlyDoneIdeas
                ? 'Alle Ideen anzeigen'
                : 'Nur getestete anzeigen';
            renderIdeaBoard();
        });
    }

    // ==============================
    // Schnell-Quiz (A1) ‚Äì Flashcards
    // ==============================
    function shuffleArray(arr) {
        const a = arr.slice();
        for (let i = a.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
    }

    function startLightningQuiz() {
        const a1Fruits = fruits.filter(f => f.levelCode === 'A1');
        const shuffled = shuffleArray(a1Fruits);
        const subset = shuffled.slice(0, Math.min(7, shuffled.length)); // ÿ≠ÿ™Ÿâ 7 ŸÉÿ±Ÿàÿ™

        quizList.innerHTML = '';
        quizStats = { total: 0, correct: 0 };
        updateQuizInfo();

        quizMeta.textContent = `Fragen in dieser Runde: ${subset.length} ¬∑ Niveau A1`;

        subset.forEach(fruit => {
            const card = document.createElement('article');
            card.className = 'quiz-card';

            card.innerHTML = `
                <div class="quiz-card-img">
                    <img src="${fruit.img}" alt="${fruit.alt}">
                </div>
                <div class="quiz-card-body">
                    <div class="quiz-ar" lang="ar" dir="rtl">${fruit.arName}</div>
                    <div class="quiz-de">${fruit.article} ${fruit.deName}</div>
                    <div class="quiz-status"></div>
                    <div class="quiz-actions">
                        <button class="control-button small show-solution" type="button">
                            L√∂sung zeigen
                        </button>
                        <button class="control-button small know-btn" type="button" disabled>
                            ‚úÖ Ich wusste es
                        </button>
                        <button class="control-button small dontknow-btn" type="button" disabled>
                            ‚ùå Ich wusste es nicht
                        </button>
                    </div>
                </div>
            `;

            const deEl = card.querySelector('.quiz-de');
            const showBtn = card.querySelector('.show-solution');
            const knowBtn = card.querySelector('.know-btn');
            const dontBtn = card.querySelector('.dontknow-btn');
            const statusEl = card.querySelector('.quiz-status');

            // ŸÜÿÆŸÅŸä ÿßŸÑŸÜÿµ ÿßŸÑÿ£ŸÑŸÖÿßŸÜŸä ÿ≠ÿ™Ÿâ Ÿäÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ L√∂sung zeigen
            deEl.style.display = 'none';

            showBtn.addEventListener('click', () => {
                deEl.style.display = 'block';
                knowBtn.disabled = false;
                dontBtn.disabled = false;
                statusEl.textContent = '';
            });

            function lockCard() {
                showBtn.disabled = true;
                knowBtn.disabled = true;
                dontBtn.disabled = true;
            }

            knowBtn.addEventListener('click', () => {
                quizStats.total += 1;
                quizStats.correct += 1;
                card.classList.add('known');
                card.classList.remove('unknown');
                statusEl.textContent = '‚úÖ Stark gemacht! Du hast es gewusst.';
                lockCard();
                updateQuizInfo();
            });

            dontBtn.addEventListener('click', () => {
                quizStats.total += 1;
                card.classList.add('unknown');
                card.classList.remove('known');
                statusEl.textContent = '‚ùå Kein Problem ‚Äì diese Karte kannst du sp√§ter noch einmal √ºben.';
                lockCard();
                updateQuizInfo();
            });

            quizList.appendChild(card);
        });

        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿ© ÿßŸÑŸÉŸàŸäÿ≤
        setActivePage('page-quiz');
    }

    lightningQuizBtn.addEventListener('click', () => {
        startLightningQuiz();
    });

    quizCloseBtn.addEventListener('click', () => {
        setActivePage('page-learn');
    });

    // ==============================
    // ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ (Zertifikate)
    // ==============================
    function renderCertIcons() {
        certIconsEl.innerHTML = '';
        if (certificates.length === 0) {
            const empty = document.createElement('span');
            empty.textContent = '‚Äî';
            empty.style.opacity = '0.7';
            certIconsEl.appendChild(empty);
            return;
        }

        certificates.slice(0, 6).forEach((cert, index) => {
            const icon = document.createElement('div');
            icon.className = 'cert-icon' + (index === certificates.length - 1 ? ' highlight' : '');
            icon.textContent = 'üìú';
            certIconsEl.appendChild(icon);
        });

        if (certificates.length > 6) {
            const more = document.createElement('div');
            more.className = 'cert-icon';
            more.textContent = `+${certificates.length - 6}`;
            certIconsEl.appendChild(more);
        }
    }

    function formatDate(dateISO) {
        const d = new Date(dateISO);
        if (isNaN(d)) return dateISO;
        const day = String(d.getDate()).padStart(2, '0');
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const year = d.getFullYear();
        return `${day}.${month}.${year}`;
    }

    function renderCertificates() {
        certListEl.innerHTML = '';

        if (certificates.length === 0) {
            const empty = document.createElement('p');
            empty.textContent = 'Noch keine Zertifikate vorhanden. Lerne einige Fr√ºchte und erzeuge dann dein erstes Zertifikat.';
            empty.style.fontSize = '0.85rem';
            empty.style.opacity = '0.9';
            certListEl.appendChild(empty);
            return;
        }

        certificates.forEach(cert => {
            const card = document.createElement('article');
            card.className = 'cert-card';

            card.innerHTML = `
                <div class="cert-ribbon">Zertifikat</div>
                <div class="cert-title">Alolo Fr√ºchte ¬∑ ${cert.title}</div>
                <div class="cert-meta">
                    Datum: ${formatDate(cert.dateISO)} ¬∑ ID: ${cert.id}
                    ¬∑ Gelernt: ${cert.learnedCount} / ${cert.totalFruits} ¬∑ ${cert.xp} XP
                </div>
                <p class="cert-text-de">
                    Dieses Zertifikat best√§tigt, dass ${cert.name} im Rahmen des
                    <strong>Alolo Fr√ºchte-Katalogs</strong> erfolgreich Vokabeln zum Thema Obst
                    auf Deutsch und Arabisch gelernt und ge√ºbt hat.
                </p>
                <p class="cert-text-de">
                    Der Inhaber dieser Urkunde hat aktiv mit Bildern, Aussprache und kurzen Beispiels√§tzen gearbeitet.
                    Diese Bescheinigung wird von unserem Lernprojekt anerkannt und kann gegen√ºber interessierten
                    Personen als Nachweis des pers√∂nlichen Engagements vorgelegt werden.
                </p>
                <p class="cert-text-ar" dir="rtl" lang="ar">
                    Ÿäÿ§ŸÉŸëÿØ Ÿáÿ∞ÿß ÿßŸÑÿ¥ŸáÿßÿØÿ© ÿ£ŸÜŸë <strong>${cert.nameArabic}</strong> ŸÇÿØ ÿ£ŸÜÿ¨ÿ≤ ÿ™ÿØÿ±Ÿäÿ®ÿßŸã ÿ®ÿµÿ±ŸäÿßŸã‚Äìÿ≥ŸÖÿπŸäÿßŸã
                    ŸÅŸä ¬´ŸÉÿ™ÿßŸÑŸàÿ¨ ÿßŸÑŸÅŸàÿßŸÉŸá¬ª Ÿàÿ™ÿπŸÑŸëŸÖ ŸÖÿ¨ŸÖŸàÿπÿ© ŸÖŸÜ ÿßŸÑŸÖŸÅÿ±ÿØÿßÿ™ ÿßŸÑÿ£ŸÑŸÖÿßŸÜŸäÿ© ŸÖÿπ ÿ™ÿ±ÿ¨ŸÖÿ™Ÿáÿß ÿßŸÑÿπÿ±ÿ®Ÿäÿ©.
                    Ÿäÿ™ŸÖŸÜŸëŸâ ŸÖŸàŸÇÿπŸÜÿß ŸÑŸá/ŸÑŸáÿß ÿßŸÑŸÜÿ¨ÿßÿ≠ ÿßŸÑÿØÿßÿ¶ŸÖÿå ŸàŸäÿ§ŸÉŸëÿØ ŸÑŸÖŸÜ ŸäŸáŸÖŸëŸá ÿßŸÑÿ£ŸÖÿ± ÿ£ŸÜŸë ÿ≠ÿßŸÖŸÑ Ÿáÿ∞Ÿá ÿßŸÑÿ¥ŸáÿßÿØÿ©
                    ŸÖÿπÿ™ÿ±ŸÅ ÿ®Ÿá ŸÖŸÜ ŸÇÿ®ŸÑ ŸÅÿ±ŸäŸÇ ŸÖŸàŸÇÿπ Alolo ÿ∂ŸÖŸÜ Ÿáÿ∞ÿß ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ŸÖŸÜ ÿßŸÑÿ™ÿπŸÑŸëŸÖ.
                </p>
            `;

            certListEl.appendChild(card);
        });

        renderCertIcons();
    }

    function generateCertificateObject() {
        const learnedCount = learnedSet.size;
        const xp = calculateXP();

        // ÿ≠ÿØŸàÿØ ÿ®ÿ≥Ÿäÿ∑ÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸàŸâ
        let title = 'Fr√ºchte Starter';
        if (learnedCount >= 10 && learnedCount < totalFruits) {
            title = 'Fr√ºchte Basis';
        } else if (learnedCount === totalFruits && totalFruits > 0) {
            title = 'Fr√ºchte Meister';
        }

        const now = new Date();
        const id = 'FR-' + now.getTime().toString(36).toUpperCase();

        // ŸäŸÖŸÉŸÜ ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿßÿ≥ŸÖ ŸáŸÜÿß ŸÉŸÖÿß ÿ™ÿ≠ÿ® ŸÑÿßÿ≠ŸÇÿßŸã
        const name = 'Herr Alolo';
        const nameArabic = 'Herr Alolo';

        return {
            id,
            dateISO: now.toISOString(),
            title,
            learnedCount,
            totalFruits,
            xp,
            name,
            nameArabic
        };
    }

    generateCertBtn.addEventListener('click', () => {
        const learnedCount = learnedSet.size;

        if (learnedCount < 3) {
            alert('Erzeuge dein Zertifikat, nachdem du mindestens 3 Karten als ‚ÄûGelernt‚Äú markiert hast.');
            return;
        }

        const cert = generateCertificateObject();
        certificates.push(cert);
        saveCertificates();
        renderCertificates();
        setActivePage('page-certificates');

        alert('Dein Zertifikat wurde erzeugt und oben unter ‚ÄûZertifikate‚Äú gespeichert.');
    });

    // ==============================
    // ÿ±ÿ≥ŸÖ ÿ£ŸàŸÑŸä
    // ==============================
    populateIdeaFilters();
    renderFruits();
    renderDailyChallenge();
    renderCertificates();
    renderIdeaBoard();
    renderCertIcons();
</script>
</body>
</html>
